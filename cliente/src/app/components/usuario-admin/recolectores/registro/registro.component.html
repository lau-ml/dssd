<div class="container">
    <app-breadcrumb [links]="links" [activeLabel]="activeLabel" [icon]="'fas fa-file-alt'"></app-breadcrumb>

    <h2 class="font-weight-bold mb-4 text-success">Registro de Recolección</h2>

    <div class="card shadow-lg border-0 mb-4" *ngIf="registroRecoleccion else errorTemplate">
        <div class="card-header bg-success text-white">
            <h4 class="mb-0">Detalles del Registro</h4>
        </div>
        <div class="card-body">
            <div class="row mb-3">
                <div class="col-md-6">
                    <strong>Fecha:</strong> {{ registroRecoleccion.fechaRecoleccion | date }}
                </div>
                <div class="col-md-6">
                    <strong>Completado:</strong>
                    <span [ngClass]="{
                            'text-success font-weight-bold': registroRecoleccion.completado,
                            'text-danger font-weight-bold': !registroRecoleccion.completado
                        }">
                        {{ registroRecoleccion.completado ? 'Sí' : 'No' }}
                    </span>
                </div>
                <div class="col-md-6">
                    <strong>Verificado:</strong>
                    <span [ngClass]="{
                            'text-success font-weight-bold': registroRecoleccion.verificado,
                            'text-danger font-weight-bold': !registroRecoleccion.verificado
                        }">
                        {{ registroRecoleccion.verificado ? 'Sí' : 'No' }}
                    </span>
                </div>
            </div>

            <h5 class="mt-4 text-success">Detalles de Materiales</h5>
            <div class="table-responsive mb-4">
                <table class="table table-striped table-bordered">
                    <thead class="table-success text-center">
                        <tr>
                            <th>Material</th>
                            <th>Cantidad Recolectada</th>
                            <th>Cantidad Entregada</th>
                            <th>Punto de Recolección</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr *ngFor="let detalle of registroRecoleccion?.detalleRegistros">
                            <td>{{ detalle.material.nombre }}</td>
                            <td class="text-center">{{ detalle.cantidadRecolectada }}</td>
                            <td class="text-center">{{ detalle.cantidadRecibida }}</td>
                            <td>{{ detalle.puntoDeRecoleccion.nombreEstablecimiento }}</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <div *ngIf="registroRecoleccion?.pago" class="mt-4">
                <h5 class="text-success">Información del Pago</h5>
                <div class="row">
                    <div class="col-md-4">
                        <strong>Monto:</strong>
                        <span class="text-primary font-weight-bold">
                            ${{ registroRecoleccion.pago?.monto | number: '1.2-2' }}
                        </span>
                    </div>
                    <div class="col-md-4">
                        <strong>Estado:</strong>
                        <span [ngClass]="{
                                'badge badge-success': registroRecoleccion.pago?.estado === 'PAGADO',
                                'badge badge-danger': registroRecoleccion.pago?.estado !== 'PAGADO'
                            }">
                            {{ registroRecoleccion.pago?.estado }}
                        </span>
                    </div>
                    <div class="col-md-4">
                        <strong>Fecha de Emisión:</strong>
                        {{ registroRecoleccion.pago?.fechaEmision | date }}
                    </div>
                    <div class="col-md-4 mt-3" *ngIf="registroRecoleccion?.pago?.fechaPago">
                        <strong>Fecha de Pago:</strong>
                        {{ registroRecoleccion.pago?.fechaPago | date }}
                    </div>
                </div>
            </div>
        </div>
    </div>

    <ng-template #errorTemplate>
        <div class="alert alert-danger text-center">
            <p>{{ errorMessage }}</p>
        </div>
    </ng-template>
</div>